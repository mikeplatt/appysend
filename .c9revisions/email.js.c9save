{"ts":1367930407727,"silentsave":true,"restoring":false,"patch":[[]],"length":0}
{"contributors":[],"silentsave":false,"ts":1367930372028,"patch":[[{"diffs":[[1,"var nodemailer = require('nodemailer');\n\nvar nano = require('./nano.js');\n    \n// couchDB email view username and password\nvar emailUser = 'appy';\nvar emailPassword = 'snatch123';\n\nvar mailOptions = {\n    from: \"Appy App <info@avoidthedoghouse.co.uk>\", // sender address\n    subject: \"Appy Birthday\" // Subject line\n};\n\n// email generation\nvar smtpTransport = nodemailer.createTransport(\"SMTP\",{\n    host:\"auth.smtp.1and1.co.uk\",\n    auth: {\n        user: \"info@avoidthedoghouse.co.uk\",\n        pass: \"theMOO2009\"\n    }\n});\n\nexports.createEmail = function (thisCard) {\n\n    mailOptions.to = thisCard.address;\n    mailOptions.html = '<p>' + thisCard.name + ' has sent you one of our eCards - Appy Birthday! </p><p><img src=\"https://' + emailUser + ':' + emailPassword + '@appy.cloudant.com/sent/' + thisCard.docID +'/front.png\" width=\"320px\" height=\"460px\"/><img src=\"https://' + emailUser + ':' + emailPassword + '@appy.cloudant.com/sent/' + thisCard.docID +'/back.png\" width=\"320px\" height=\"460px\"/></p>';\n\n    smtpTransport.sendMail(mailOptions, function(err, res) {\n        \n        if(err){\n            \n            console.log(err);\n            \n            nano.handleFail(thisCard);\n            \n        } else {\n            \n            console.log(\"EMAIL SENT: \" + res.message);\n            \n            nano.handleSent(thisCard);\n        }\n\n        // if you don't want to use this transport object anymore, uncomment following line\n        //smtpTransport.close(); // shut down the connection pool, no more messages\n    });\n}"]],"start1":0,"start2":0,"length1":0,"length2":1536}]],"length":1536,"saved":false}
{"contributors":[],"silentsave":false,"ts":1367937288757,"patch":[[{"diffs":[[0,"   \n"],[-1,"            console.log(err);\n            \n"],[0,"    "]],"start1":1104,"start2":1104,"length1":51,"length2":8},{"diffs":[[0,"   \n"],[-1,"            console.log(\"EMAIL SENT: \" + res.message);\n            \n"],[0,"    "]],"start1":1186,"start2":1186,"length1":76,"length2":8}]],"length":1425,"saved":false}
