{"ts":1367930374118,"silentsave":true,"restoring":false,"patch":[[]],"length":0}
{"contributors":[],"silentsave":false,"ts":1367930329707,"patch":[[{"diffs":[[1,"var fs = require('fs'),\n    quick = require('nano')('https://appy:snatch123@appy.cloudant.com/'),\n    intelliSMS = require('intellisms');\n    \nvar nano = require(\"./nano\");\n    \nvar smsUserName = 'mikeplatt';\nvar smsPassword = 'snatch123';\n\nvar sms = new intelliSMS(smsUserName, smsPassword);\n\nvar sentDB = quick.use('sent');\n\nexports.createMMS = function(thisCard) {\n\n    sentDB.attachment.get(thisCard.docID, 'front.png', function(err, body) {\n        \n        if (err) {\n            \n            console.log(err);\n            \n        } else {\n            \n            var frontFile = __dirname + '/downloads/' + thisCard.docID + 'front.png';\n            \n            fs.writeFile(frontFile, body, 'image/png', function(err, res){\n                \n                if(err) {\n                    \n                    console.log(err);\n                    \n                } else {\n            \n                    var options = {\n                        \n                        to: thisCard.address,\n                        text: \"Appy Birthday!\"\n                        \n                    };\n                \n                    var files = fs.createReadStream(frontFile);\n                    console.log(files);\n                    \n                    sms.SendMMSMessage(options, files, function(err, id) {\n            \n                        if (err) {\n                            \n                            nano.handleFail(thisCard);\n                            \n                            console.log(err);\n                            \n                        } else {\n                            \n                            nano.handleSent(thisCard);\n                            \n                            fs.unlink(frontFile);\n                            \n                            console.log('ID: %s', id);\n                        } \n                    });\n                }\n            });\n        }\n    });\n};"]],"start1":0,"start2":0,"length1":0,"length2":1935}]],"length":1935,"saved":false}
{"contributors":[],"silentsave":false,"ts":1367937213830,"patch":[[{"diffs":[[0,"   \n"],[-1,"                            console.log(err);\n                            \n"],[0,"    "]],"start1":1471,"start2":1471,"length1":83,"length2":8},{"diffs":[[0,"e);\n"],[-1,"                            \n                            console.log('ID: %s', id);\n"],[0,"    "]],"start1":1667,"start2":1667,"length1":92,"length2":8}]],"length":1776,"saved":false}
